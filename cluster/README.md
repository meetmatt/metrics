# High availability setup

### System diagram

```
+-----------------------------+   +-----------------------------+
|                             |   |                             |
|  West                       |   |   East                      |
|                             |   |                             |
|   +-----+ +-----+ +-----+   |   |   +-----+ +-----+ +-----+   |
|   | App | | App | | App |   |   |   | App | | App | | App |   |
|   +--+--+ +--+--+ +--+--+   |   |   +--+--+ +--+--+ +--+--+   |
|       \      |      /       |   |       \      |      /       |
|        \     |     /        |   |        \     |     /        |
|      +--v----v----v--+      |   |      +--v----v----v--+      | 
|      | Load Balancer |      |   |      | Load Balancer |      |
|      +----+------+---+      |   |      +---+------+----+      |
|          /        .         |   |         /        .          |
|         /          .        |   |        /          .         |
|  +-----v----+ +-----v----+  |   |  +----v-----+ +----v-----+  |
|  |   Main   | |  Backup  |  |   |  |   Main   | |  Backup  |  |
|  | Telegraf | | Telegraf |  |   |  | Telegraf | | Telegraf |  |
|  +-----+----+ +-----+----+  |   |  +----+-----+ +----+-----+  |   
|        |            .       |   |       |            .        |
+--------|------------.-------+   +-------|------------.--------+        
         |            .                   |            .        
+--------|------------.-------------------|------------.--------+
|        |            .                   |            .        |                   
|        |        +---v-------------------v---+        .        |
|        |        |                           |        .        |
|        +-------->   Ingress Load Balancer   <. . . . +        |
|                 |                           |                 |
|                 +----------+-----+----------+                 |
|                           /       \                           |
|  Center                  /         \                          |
|                     +---v---+   +---v---+                     |
|                     | Relay |   | Relay |                     |
|                     +--+--+-+   +-+--+--+                     |
|                        |   \     /   |                        |
|                        |    \   /    |                        |
|                        |     \ /     |                        |
|                        |      X      |                        |
|                        |     / \     |                        |
|                        |    /   \    |                        |
|                        |   /     \   |                        |
|                +-------v--v-+   +-v--v-------+                |
|                |            |   |            |                |
|                |   Influx   |   |   Influx   |                |
|                |            |   |            |                |
|                +--------+---+   +---+--------+                |
|                          \         /                          |
|                           \       /                           |
|                    +-------v-----v--------+                   |
|                    |  Query Load Balancer |                   |
|                    +----------------------+                   |
|                               ^                               |
|                               |                               |
+-------------------------------|-------------------------------+
                                |
                  +-------------|------------+
                  | Dashboard   |            |
                  |             |            |
                  |       +-----+-----+      |
                  |       |  Grafana  |      |
                  |       +-----------+      |
                  |                          |
                  +--------------------------+
```
